<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:EducGramming.ViewModels"
             x:Class="EducGramming.Views.LessonPage"
             x:DataType="viewmodels:LessonViewModel"
             BackgroundColor="#0A1128">

    <Grid RowDefinitions="Auto,Auto,*">
        <!-- Header -->
        <Grid Grid.Row="0" 
              Padding="24,20"
              ColumnDefinitions="*,Auto"
              BackgroundColor="#1B3B6F">
            
            <Label Text="Lessons"
                   TextColor="White"
                   FontSize="32"
                   FontAttributes="Bold"
                   VerticalOptions="Center"/>

            <Border Grid.Column="1"
                    Stroke="#3B5B8F"
                    StrokeThickness="1"
                    StrokeShape="RoundRectangle 12"
                    BackgroundColor="#2C4C80"
                    Padding="8,0"
                    MinimumWidthRequest="120">
                <Picker Title="Select Language"
                        TitleColor="White"
                        TextColor="White"
                        BackgroundColor="Transparent"
                        SelectedItem="{Binding SelectedLanguage}"
                        FontSize="16">
                    <Picker.Items>
                        <x:String>C#</x:String>
                        <x:String>Java</x:String>
                    </Picker.Items>
                </Picker>
            </Border>
        </Grid>

        <!-- Tab Buttons -->
        <Border Grid.Row="1" 
                BackgroundColor="#4B0082"
                Stroke="Transparent"
                Padding="24,0">
            <HorizontalStackLayout Spacing="4">
                <Button Text="Lessons"
                        HeightRequest="48"
                        Padding="24,0"
                        BackgroundColor="{Binding CurrentTab, Converter={StaticResource TabToColorConverter}, ConverterParameter=Lessons}"
                        TextColor="White"
                        Command="{Binding ChangeTabCommand}"
                        CommandParameter="Lessons"
                        FontAttributes="Bold"
                        FontSize="16"
                        CornerRadius="8"/>
                <Button Text="Videos"
                        HeightRequest="48"
                        Padding="24,0"
                        BackgroundColor="{Binding CurrentTab, Converter={StaticResource TabToColorConverter}, ConverterParameter=Videos}"
                        TextColor="White"
                        Command="{Binding ChangeTabCommand}"
                        CommandParameter="Videos"
                        FontAttributes="Bold"
                        FontSize="16"
                        CornerRadius="8"/>
                <Button Text="Quizzes"
                        HeightRequest="48"
                        Padding="24,0"
                        BackgroundColor="{Binding CurrentTab, Converter={StaticResource TabToColorConverter}, ConverterParameter=Quizzes}"
                        TextColor="White"
                        Command="{Binding ChangeTabCommand}"
                        CommandParameter="Quizzes"
                        FontAttributes="Bold"
                        FontSize="16"
                        CornerRadius="8"/>
            </HorizontalStackLayout>
        </Border>

        <!-- Content Area -->
        <ScrollView Grid.Row="2">
            <Grid Padding="24,16">
                <!-- Lessons Content -->
                <CollectionView ItemsSource="{Binding Lessons}"
                              IsVisible="{Binding CurrentTab, Converter={StaticResource StringEqualsConverter}, ConverterParameter=Lessons}">
                    <CollectionView.ItemTemplate>
                        <DataTemplate x:DataType="viewmodels:LessonItem">
                            <Border Margin="0,8"
                                   StrokeShape="RoundRectangle 16"
                                   BackgroundColor="#1B3B6F"
                                   Stroke="#3B5B8F"
                                   StrokeThickness="1">
                                <Border.Shadow>
                                    <Shadow Brush="#000000"
                                           Offset="0,4"
                                           Radius="8"
                                           Opacity="0.2"/>
                                </Border.Shadow>
                                <Grid Padding="20" RowSpacing="8">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <Label Text="{Binding Title}"
                                           TextColor="White"
                                           FontSize="22"
                                           FontAttributes="Bold"/>
                                    <Label Grid.Row="1"
                                           Text="{Binding Description}"
                                           TextColor="#B0B0B0"
                                           FontSize="16"
                                           LineBreakMode="WordWrap"/>
                                    <Button Grid.Row="2"
                                            Text="Start Learning"
                                            BackgroundColor="#4B0082"
                                            TextColor="White"
                                            CornerRadius="8"
                                            Margin="0,10,0,0"
                                            HeightRequest="40"/>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                    <CollectionView.EmptyView>
                        <Grid VerticalOptions="Center" 
                              Padding="20"
                              RowSpacing="12">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Image Source="empty_state.svg"
                                   HeightRequest="120"
                                   Aspect="AspectFit"
                                   HorizontalOptions="Center"/>
                            <Label Grid.Row="1"
                                   Text="No lessons available yet"
                                   TextColor="#B0B0B0"
                                   FontSize="18"
                                   HorizontalOptions="Center"/>
                        </Grid>
                    </CollectionView.EmptyView>
                </CollectionView>

                <!-- Videos Content -->
                <CollectionView ItemsSource="{Binding Videos}"
                              IsVisible="{Binding CurrentTab, Converter={StaticResource StringEqualsConverter}, ConverterParameter=Videos}">
                    <CollectionView.ItemTemplate>
                        <DataTemplate x:DataType="viewmodels:LessonItem">
                            <Border Margin="0,8"
                                   StrokeShape="RoundRectangle 16"
                                   BackgroundColor="#1B3B6F"
                                   Stroke="#3B5B8F"
                                   StrokeThickness="1">
                                <Border.GestureRecognizers>
                                    <TapGestureRecognizer Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:LessonViewModel}}, Path=OpenVideoCommand}"
                                                        CommandParameter="{Binding .}"/>
                                </Border.GestureRecognizers>
                                <Border.Shadow>
                                    <Shadow Brush="#000000"
                                           Offset="0,4"
                                           Radius="8"
                                           Opacity="0.2"/>
                                </Border.Shadow>
                                <Grid Padding="20" RowSpacing="8">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <Label Text="{Binding Title}"
                                           TextColor="White"
                                           FontSize="22"
                                           FontAttributes="Bold"/>
                                    <Label Grid.Row="1"
                                           Text="{Binding Description}"
                                           TextColor="#B0B0B0"
                                           FontSize="16"
                                           LineBreakMode="WordWrap"/>
                                    <Button Grid.Row="2"
                                            Text="Watch Video"
                                            BackgroundColor="#4B0082"
                                            TextColor="White"
                                            CornerRadius="8"
                                            Margin="0,10,0,0"
                                            HeightRequest="40"
                                            Command="{Binding Source={RelativeSource AncestorType={x:Type viewmodels:LessonViewModel}}, Path=OpenVideoCommand}"
                                            CommandParameter="{Binding .}"/>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                    <CollectionView.EmptyView>
                        <Grid VerticalOptions="Center" 
                              Padding="20"
                              RowSpacing="12">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Image Source="empty_state.svg"
                                   HeightRequest="120"
                                   Aspect="AspectFit"
                                   HorizontalOptions="Center"/>
                            <Label Grid.Row="1"
                                   Text="No videos available yet"
                                   TextColor="#B0B0B0"
                                   FontSize="18"
                                   HorizontalOptions="Center"/>
                        </Grid>
                    </CollectionView.EmptyView>
                </CollectionView>

                <!-- Quizzes Content -->
                <CollectionView ItemsSource="{Binding Quizzes}"
                              IsVisible="{Binding CurrentTab, Converter={StaticResource StringEqualsConverter}, ConverterParameter=Quizzes}">
                    <CollectionView.ItemTemplate>
                        <DataTemplate x:DataType="viewmodels:LessonItem">
                            <Border Margin="0,8"
                                   StrokeShape="RoundRectangle 16"
                                   BackgroundColor="#1B3B6F"
                                   Stroke="#3B5B8F"
                                   StrokeThickness="1">
                                <Border.Shadow>
                                    <Shadow Brush="#000000"
                                           Offset="0,4"
                                           Radius="8"
                                           Opacity="0.2"/>
                                </Border.Shadow>
                                <Grid Padding="20" RowSpacing="8">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <Label Text="{Binding Title}"
                                           TextColor="White"
                                           FontSize="22"
                                           FontAttributes="Bold"/>
                                    <Label Grid.Row="1"
                                           Text="{Binding Description}"
                                           TextColor="#B0B0B0"
                                           FontSize="16"
                                           LineBreakMode="WordWrap"/>
                                    <Button Grid.Row="2"
                                            Text="Start Quiz"
                                            BackgroundColor="#4B0082"
                                            TextColor="White"
                                            CornerRadius="8"
                                            Margin="0,10,0,0"
                                            HeightRequest="40"/>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                    <CollectionView.EmptyView>
                        <Grid VerticalOptions="Center" 
                              Padding="20"
                              RowSpacing="12">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Image Source="empty_state.svg"
                                   HeightRequest="120"
                                   Aspect="AspectFit"
                                   HorizontalOptions="Center"/>
                            <Label Grid.Row="1"
                                   Text="No quizzes available yet"
                                   TextColor="#B0B0B0"
                                   FontSize="18"
                                   HorizontalOptions="Center"/>
                        </Grid>
                    </CollectionView.EmptyView>
                </CollectionView>
            </Grid>
        </ScrollView>
    </Grid>
</ContentPage> 